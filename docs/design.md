# 社内ドキュメントQ&Aチャットボット（RAG） 設計書

## 1. プロジェクト概要

### 1.1 背景
社内にはマニュアル、FAQ、議事録など多数のドキュメントが存在するが、
ファイルサーバやWikiに分散しており、検索性が低いという課題がある。

### 1.2 目的
自然文で質問するだけで、関連するドキュメントから回答を生成し、
参照元とともに提示することで、問い合わせ対応や情報探索の時間を削減する。

### 1.3 ターゲットユーザー
- 新入社員
- 業務マニュアルを参照するオペレーター
- プロジェクトメンバー

---

## 2. 要件

### 2.1 機能要件
- ユーザーはWeb UIから自然文で質問できること
- システムは関連ドキュメントを検索し、回答と参照元を返すこと
- ドキュメント更新時にインデックスを再構築できること

### 2.2 非機能要件
- 個人開発環境（ローカル）で動作すること
- 1クエリあたり数秒以内で応答すること
- ベクトルインデックスはローカルファイルとして保存すること

---

## 3. アーキテクチャ

### 3.1 全体構成
- UI: Streamlit
- API: FastAPI
- LLM: OpenAI GPT-4 など（API）
- Embedding: text-embedding-3-small など
- ベクトルストア: FAISS

### 3.2 データフロー
1. ドキュメント取り込みバッチ
2. 質問処理フロー（シーケンス図イメージ）

---

## 4. データ設計

### 4.1 ドキュメントチャンク構造
- `id`
- `text`
- `source_file`
- `section_title`
- `embedding` （ベクトル）

---

## 5. 実装詳細

### 5.1 モジュール構成
- `src/ingestion/*`
- `src/rag/*`
- `src/api/main.py`
- `src/ui/app.py`

### 5.2 プロンプト設計
- 回答時に「参照元ドキュメントのタイトルとセクション名」を必ず含めるよう指示

---

## 6. 今後の拡張
- 認証（社内ユーザーのみ利用）
- ドキュメントの自動クロール
- フィードバックループによる回答改善
